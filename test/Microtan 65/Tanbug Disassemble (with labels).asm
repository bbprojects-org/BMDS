//==============================================================================// Disassembly 09 May 2014, 17:26//// Address range://   $FC00 - $FFFE//// Data sections at://   $FE4B - $FE72//   $FFEC - $FFFF////==============================================================================NULL          equ    $0000ICHAR         equ    $0001OCHAR         equ    $0002VDUIND        equ    $0003INTFS1        equ    $0004ICURS         equ    $000ARUNIND        equ    $000CSINGLE        equ    $000DPROCED        equ    $000ESIMCOM        equ    $000FINTSL1        equ    $0010HXPKL         equ    $0013HXPKH         equ    $0014PCLBCK        equ    $0015PCHBCK        equ    $0016PSWBCK        equ    $0017SPBCK         equ    $0018XBCK          equ    $0019YBCK          equ    $001AABCK          equ    $001BMODADL        equ    $001CMODADH        equ    $001DCOPL          equ    $001ECOPH          equ    $001FBPTLO         equ    $0020BPTHI         equ    $0021BPTCOD        equ    $0030STKBSE        equ    $0100VDUSTT        equ    $0200VDUFST        equ    $0220VDUMID        equ    $0300VDUTOP        equ    $0320SGRAPH        equ    $BFF0SNMI          equ    $BFF1KBWRIT        equ    $BFF2KBREAD        equ    $BFF3              org    $FC00              ldx    #$FF                            txs                                    inx                                    stx    PSWBCK                          jsr    Lbl_FFB7                        sta    KBREAD                          ldx    #$0E              Lbl_FC0E      lda    SETUP,X                         sta    INTFS1,X                        dex                                    bpl    Lbl_FC0E                        inx                                    stx    KBWRIT                          sta    SGRAPH                          dex                                    stx    KBWRIT                          inx                                    lda    KBREAD                          bpl    Lbl_FC29                        inc    SIMCOM            Lbl_FC29      sta    SGRAPH            Lbl_FC2C      lda    HDR,X                           beq    MONTOR                          jsr    OPCHR                           inx                                    bne    Lbl_FC2C          MONTOR        cld                                    cli                                    jsr    POLLKB                          lda    ICHAR                           cmp    #$21                            bmi    Lbl_FC48          Lbl_FC42      jsr    OPCHR                           jmp    MONTOR            Lbl_FC48      jsr    Lbl_FC4F          Lbl_FC4B      lda    #$0D                            bne    Lbl_FC42          Lbl_FC4F      ldy    #$00                            lda    (ICURS),Y                       tax                                    iny                                    lda    (ICURS),Y                       bpl    Lbl_FC8F                        lda    #$00                            cpx    #$53                            bne    Lbl_FC62                        stx    SINGLE                          rts                      Lbl_FC62      cpx    #$4E                            bne    Lbl_FC69                        sta    SINGLE                          rts                      Lbl_FC69      cpx    #$50                            bne    Lbl_FC71                        sta    PROCED                          beq    Lbl_FCC7          Lbl_FC71      cpx    #$52                            bne    Lbl_FC7E                        sta    MODADH                          lda    #$15                            sta    MODADL                          jmp    Lbl_FDE5          Lbl_FC7E      cpx    #$42                            bne    Lbl_FC86                        jsr    Lbl_FFB7                        rts                      Lbl_FC86      jmp    $F7F7             Lbl_FC89      lda    #$3F                            jsr    OPCHR                           rts                      Lbl_FC8F      dey                                    txa                                    pha                                    jsr    HEXPCK                          bne    Lbl_FCEB                        pla                                    bvc    Lbl_FC86                        cmp    #$47                            bne    Lbl_FCBF                        ldx    #$00                            stx    PROCED                          dex                      Lbl_FCA3      txs                                    lda    HXPKH                           pha                                    lda    HXPKL                           pha                                    lda    PSWBCK                          pha                                    dec    RUNIND                          lda    #$20                            ldy    VDUIND                          sta    (ICURS),Y                       ldx    XBCK                            ldy    YBCK              Lbl_FCB9      lda    ABCK                            sta    SNMI                            rti                      Lbl_FCBF      cmp    #$50                            bne    Lbl_FCD4                        lda    HXPKL                           sta    PROCED            Lbl_FCC7      lda    PCHBCK                          sta    HXPKH                           lda    PCLBCK                          sta    HXPKL                           ldx    SPBCK                           jmp    Lbl_FCA3          Lbl_FCD4      cmp    #$4D                            bne    Lbl_FC86                        lda    #$2C                            jsr    OPCHR                           ldy    #$00                            lda    (HXPKL),Y                       jsr    HEXPNT                          pla                                    pla                                    lda    #$2C                            jmp    Lbl_FC42          Lbl_FCEB      cpx    #$2C                            beq    Lbl_FCF3          Lbl_FCEF      pla                      Lbl_FCF0      jmp    Lbl_FC86          Lbl_FCF3      lda    HXPKL                           sta    MODADL                          lda    HXPKH                           sta    MODADH                          jsr    HEXPCK                          bne    Lbl_FD7C                        pla                                    bvc    Lbl_FCF0                        cmp    #$4C                            beq    Lbl_FD49                        cmp    #$4F                            bne    Lbl_FD32                        lda    HXPKL                           sec                                    sbc    #$02                            bcs    Lbl_FD14                        dec    HXPKH             Lbl_FD14      sec                                    sbc    MODADL                          tax                                    lda    HXPKH                           sbc    MODADH                          tay                                    txa                                    bmi    Lbl_FD25                        tya                                    bne    Lbl_FCF0                        beq    Lbl_FD28          Lbl_FD25      iny                                    bne    Lbl_FCF0          Lbl_FD28      lda    #$3D                            jsr    OPCHR                           txa                                    jsr    HEXPNT                          rts                      Lbl_FD32      cmp    #$42              Lbl_FD34      bne    Lbl_FCF0                        lda    HXPKL                           bmi    Lbl_FCF0                        cmp    #$08                            bpl    Lbl_FCF0                        asl    A                               tax                                    lda    MODADL                          sta    BPTLO,X                         lda    MODADH                          sta    BPTHI,X           Lbl_FD48      rts                      Lbl_FD49      jsr    OUTPCR                          ldy    #$00                            lda    MODADH                          jsr    HEXPNT                          lda    MODADL            Lbl_FD55      jsr    HEXPNT                          lda    #$20                            jsr    OPCHR                           lda    (MODADL),Y                      iny                                    cpy    #$09                            bmi    Lbl_FD55                        dec    HXPKL                           beq    Lbl_FD48                        nop                                    nop                                    nop                                    nop                                    nop                                    nop                                    lda    MODADL                          clc                                    adc    #$08                            sta    MODADL                          bcc    Lbl_FD49                        inc    MODADH                          jmp    Lbl_FD49          Lbl_FD7C      cpx    #$2C                            beq    Lbl_FD83          Lbl_FD80      jmp    Lbl_FCEF          Lbl_FD83      lda    HXPKL                           sta    COPL                            lda    HXPKH                           sta    COPH                            jsr    HEXPCK                          bne    Lbl_FD80                        pla                                    cmp    #$4D                            beq    Lbl_FDBC                        cmp    #$43                            bne    Lbl_FD34                        bvc    Lbl_FD34                        ldy    #$00              Lbl_FD9D      lda    (MODADL),Y                      sta    (HXPKL),Y                       lda    COPH                            cmp    MODADH                          bne    Lbl_FDAD                        lda    COPL                            cmp    MODADL                          beq    Lbl_FE08          Lbl_FDAD      inc    MODADL                          bne    Lbl_FDB3                        inc    MODADH            Lbl_FDB3      inc    HXPKL                           bne    Lbl_FD9D                        inc    HXPKH                           bne    Lbl_FD9D                        rts                      Lbl_FDBC      ldx    ICHAR                           cpx    #$20                            beq    Lbl_FDE5                        bvc    Lbl_FDCA                        lda    HXPKL                           ldy    #$00                            sta    (MODADL),Y        Lbl_FDCA      cpx    #$0A                            beq    Lbl_FDDF                        cpx    #$1B                            bne    Lbl_FE08                        dec    MODADL                          lda    MODADL                          cmp    #$FF                            bne    Lbl_FDE5                        dec    MODADH                          jmp    Lbl_FDE5          Lbl_FDDF      inc    MODADL                          bne    Lbl_FDE5                        inc    MODADH            Lbl_FDE5      jsr    OUTPCR                          lda    #$4D                            jsr    OPCHR                           lda    MODADH                          jsr    HEXPNT                          lda    MODADL                          jsr    HEXPNT                          jmp    Lbl_FC4F          POLLKB        lda    #$00                            pha                                    sta    ICHAR                           cmp    SIMCOM                          bne    Lbl_FE09          Lbl_FE03      cmp    ICHAR                           beq    Lbl_FE03          Lbl_FE07      pla                      Lbl_FE08      rts                      Lbl_FE09      lda    #$0F                            sta    KBWRIT                          lda    KBREAD                          bne    Lbl_FE09                        ldx    #$40              Lbl_FE15      dey                                    bne    Lbl_FE15                        dex                                    bne    Lbl_FE15          Lbl_FE1B      ldy    #$FF                            pla                                    pha                                    beq    Lbl_FE23                        ldy    #$13              Lbl_FE23      ldx    #$08              Lbl_FE25      stx    KBWRIT                          lda    KBREAD                          bne    Lbl_FE39                        iny                                    iny                                    iny                                    iny                                    iny                                    txa                                    lsr    A                               tax                                    beq    Lbl_FE1B                        bne    Lbl_FE25          Lbl_FE39      iny                                    lsr    A                               bcc    Lbl_FE39                        lda    Lbl_FE4B,Y                      sta    ICHAR                           bne    Lbl_FE07                        pla                                    eor    #$FF                            pha                                    jmp    Lbl_FE09          Lbl_FE4B      fcb    $33               // 3              fcb    $37               // 7              fcb    $42               // B              fcb    $46               // F              fcb    $3F               // ?              fcb    $32               // 2              fcb    $36               // 6              fcb    $41               // A              fcb    $45               // E              fcb    $0D               //               fcb    $31               // 1              fcb    $35               // 5              fcb    $39               // 9              fcb    $44               // D              fcb    $0A               //               fcb    $30               // 0              fcb    $34               // 4              fcb    $38               // 8              fcb    $43               // C              fcb    $00               //               fcb    $2C               // ,              fcb    $52               // R              fcb    $4C               // L              fcb    $4E               // N              fcb    $3F               // ?              fcb    $32               // 2              fcb    $43               // C              fcb    $49               // I              fcb    $53               // S              fcb    $20               //                fcb    $31               // 1              fcb    $4F               // O              fcb    $1B               //               fcb    $47               // G              fcb    $7F               //               fcb    $30               // 0              fcb    $34               // 4              fcb    $50               // P              fcb    $4D               // M              fcb    $00               // OUTPCR        lda    #$0D              OPCHR         sta    OCHAR                           txa                                    pha                                    tya                                    pha                                    ldy    VDUIND                          lda    #$20                            sta    (ICURS),Y                       ldx    OCHAR                           cpx    #$7F                            bne    Lbl_FE97                        dey                                    bpl    Lbl_FE8C          Lbl_FE8A      ldy    #$00              Lbl_FE8C      lda    #$FF                            sta    (ICURS),Y         Lbl_FE90      sty    VDUIND                          pla                                    tay                                    pla                                    tax                                    rts                      Lbl_FE97      cpx    #$0D                            beq    Lbl_FEA3                        txa                                    sta    (ICURS),Y                       iny                                    cpy    #$20                            bmi    Lbl_FE8C          Lbl_FEA3      ldx    #$00              Lbl_FEA5      lda    VDUFST,X                        sta    VDUSTT,X                        inx                                    bne    Lbl_FEA5          Lbl_FEAE      lda    VDUTOP,X                        sta    VDUMID,X                        inx                                    cpx    #$E0                            bne    Lbl_FEAE                        lda    #$20                            tay                      Lbl_FEBC      dey                                    sta    (ICURS),Y         Lbl_FEBF      bne    Lbl_FEBC                        beq    Lbl_FE8A          Lbl_FEC3      pha                                    cld                                    txa                                    pha                                    tsx                                    inx                                    inx                                    inx                                    lda    STKBSE,X                        and    #$10                            bne    Lbl_FEF0                        pla                                    tax                                    lda    KBREAD                          bmi    Lbl_FEDD          Lbl_FED9      pla                                    jmp    INTSL1            Lbl_FEDD      and    #$7F                            sta    ICHAR                           sta    SGRAPH                          cmp    #$1B                            bne    Lbl_FED9                        lda    RUNIND                          bne    Lbl_FED9                        sta    PROCED                          beq    Lbl_FF02          Lbl_FEF0      inx                                    sec                                    lda    STKBSE,X                        sbc    #$02                            sta    STKBSE,X                        bcs    Lbl_FF00                        inx                                    dec    STKBSE,X          Lbl_FF00      pla                                    tax                      Lbl_FF02      pla                                    sta    ABCK                            jsr    Lbl_FFC1                        jmp    Lbl_FF75          HEXPNT        pha                                    ldx    #$01                            lsr    A                               lsr    A                               lsr    A                               lsr    A                 Lbl_FF12      clc                                    adc    #$30                            cmp    #$3A                            bmi    Lbl_FF1C                        clc                                    adc    #$07              Lbl_FF1C      jsr    OPCHR                           dex                                    bpl    Lbl_FF23                        rts                      Lbl_FF23      pla                                    and    #$0F                            bpl    Lbl_FF12          HEXPCK        lda    #$00                            pha                                    sta    HXPKL                           sta    HXPKH             Lbl_FF2F      iny                                    lda    (ICURS),Y                       tax                                    sec                                    sbc    #$30                            bmi    Lbl_FF48                        cmp    #$0A                            bmi    Lbl_FF4C                        sec                                    sbc    #$11                            bmi    Lbl_FF48                        clc                                    adc    #$0A                            cmp    #$10                            bmi    Lbl_FF4C          Lbl_FF48      plp                                    cpx    #$FF                            rts                      Lbl_FF4C      ldx    #$04              Lbl_FF4E      asl    HXPKH                           asl    HXPKL                           bcc    Lbl_FF56                        inc    HXPKH             Lbl_FF56      dex                                    bne    Lbl_FF4E                        clc                                    adc    HXPKL                           sta    HXPKL                           pla                                    lda    #$40                            pha                                    bne    Lbl_FF2F          Lbl_FF64      sta    ABCK                            cld                                    lda    SINGLE                          bne    Lbl_FF75                        txa                                    pha                                    jsr    Lbl_FFD0                        pla                                    tax                                    lda    ABCK                            rti                      Lbl_FF75      lda    PROCED                          beq    Lbl_FF7E                        dec    PROCED                          jmp    Lbl_FCB9          Lbl_FF7E      inc    RUNIND                          pla                                    sta    PSWBCK                          pla                                    sta    PCLBCK                          pla                                    sta    PCHBCK                          stx    XBCK                            sty    YBCK                            tsx                                    stx    SPBCK                           jsr    OUTPCR                          lda    PCHBCK                          jsr    HEXPNT                          lda    PCLBCK                          jsr    HEXPNT                          ldy    #$00              Lbl_FF9F      lda    #$20                            pha                                    jsr    OPCHR                           pla                                    jsr    OPCHR                           lda    PSWBCK,Y                        jsr    HEXPNT                          iny                                    cpy    #$05                            bmi    Lbl_FF9F                        jmp    Lbl_FC4B          Lbl_FFB7      ldx    #$1F                            lda    #$00              Lbl_FFBB      sta    BPTLO,X                         dex                                    bpl    Lbl_FFBB                        rts                      Lbl_FFC1      txa                                    pha                                    ldx    #$0E              Lbl_FFC5      lda    BPTCOD,X                        sta    (BPTLO,X)                       dex                                    dex                                    bpl    Lbl_FFC5                        pla                                    tax                                    rts                      Lbl_FFD0      ldx    #$0E              Lbl_FFD2      lda    (BPTLO,X)                       sta    BPTCOD,X                        lda    #$00                            sta    (BPTLO,X)                       dex                                    dex                                    bpl    Lbl_FFD2                        rts                      SETUP         jmp    Lbl_FEC3                        jmp    Lbl_FF64                        cpx    #$03                            ora    (NULL,X)                        brk                                    brk                                    rti                      HDR           fcb    $0D               //               fcb    $54               // T              fcb    $41               // A              fcb    $4E               // N              fcb    $42               // B              fcb    $55               // U              fcb    $47               // G              fcb    $0D               //               fcb    $00               //               fcb    $00               //               fcb    $00               //               fcb    $4C               // L              fcb    $89               //               fcb    $FC               //               fcb    $07               //               fcb    $00               //               fcb    $00               //               fcb    $FC               //               fcb    $04               // 